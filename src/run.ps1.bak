$sourceDir = "./"
$destDir = "../../README\"  # 明确目录标识

# 检查目标路径是否为文件
if (Test-Path $destDir -PathType Leaf) {
    Write-Error "错误：目标路径指向文件！请修改为目录路径"
    exit 1
}

# 确保目录存在
if (-not (Test-Path $destDir)) {
    New-Item -ItemType Directory -Path $destDir | Out-Null
}

Get-ChildItem -Path $sourceDir -Recurse -Filter "README.md" | ForEach-Object {
    $folderName = $_.Directory.Name
    $newFileName = "$folderName.md"
    $destPath = Join-Path -Path $destDir -ChildPath $newFileName
    
    # 调试信息（可选）
    Write-Host "复制: [$folderName] -> $destPath"
    
    Copy-Item -Path $_.FullName -Destination $destPath -Force
}

Write-Host "完成！文件保存到: $(Resolve-Path $destDir)"